<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGL</title>
    
    <style>
        html, body {
          width: 100%;
          height: 100%;
          margin: 0px;
          border: 0;
          overflow: hidden; /*  Disable scrollbars */
          display: block;  /* No floating content on sides */
        }

        /*canvas {
            box-sizing: border-box;
            border-style: none;
            margin: 0px;
            width: 100vw;
            height: 100vh;
            display: block;
        }*/
    </style>
    
</head>
<body>
    <div id="canvasContainer"></div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="../dist/lux.js"></script>
    <script type="text/javascript" src="test.js"></script>
    <script id="color-vs" type="x-shader/x-vertex">#version 300 es
        in vec3 a_position;
        in vec3 a_normal;
        in vec4 a_color;
      
        uniform mat4 u_model;
        uniform mat4 u_view;
        uniform mat4 u_perspective;
      
        out vec4 fragColor;
        void main(void) {
            fragColor = a_color;
            gl_Position = u_perspective * u_view * u_model * vec4(a_position, 1.0);
        }
    </script>
    <script id="color-fs" type="x-shader/x-fragment">#version 300 es
        precision mediump float;
        
        uniform vec3 u_materialColor;

        in vec4 fragColor;

        out vec4 outputColor;
        void main(void) {
            outputColor = fragColor * vec4(u_materialColor, 1.0);
        }
    </script>
    <script id="normal-color-vs" type="x-shader/x-vertex">#version 300 es
        in vec3 a_position;
        in vec3 a_normal;
        in vec4 a_color;
      
        uniform mat4 u_model;
        uniform mat4 u_view;
        uniform mat4 u_perspective;
        uniform mat4 u_mNormal;
      
        out vec3 normal;
        //out vec4 fragColor;
        void main(void) {
            normal = (u_mNormal * vec4(a_normal, 0.0)).xyz;
            //fragColor = vec4(a_normal, 1.0);
            gl_Position = u_perspective * u_view * u_model * vec4(a_position, 1.0);
        }
    </script>
    <script id="normal-color-fs" type="x-shader/x-fragment">#version 300 es
        precision mediump float;
        
        uniform vec3 u_materialColor;

        //in vec4 fragColor;
        in vec3 normal;

        out vec4 outputColor;
        void main(void) {
            
            outputColor =  vec4(normal, 1.0);
        }
    </script>
    <script id="lambert-vs" type="x-shader/x-vertex">#version 300 es
        in vec3 a_position;
        in vec3 a_normal;
        in vec4 a_color;
      
        uniform mat4 u_model;
        uniform mat4 u_view;
        uniform mat4 u_perspective;
        uniform mat4 u_mNormal;

        out vec3 normal;
        out vec4 fragColor;
        out vec3 fragPos;
        void main(void) {
            normal = vec3(u_mNormal * vec4(a_normal, 0.0));
            fragPos = vec3(u_model * vec4(a_position, 1.0));
            fragColor = a_color;
            gl_Position = u_perspective * u_view * u_model * vec4(a_position, 1.0);
        }
    </script>
    <script id="lambert-fs" type="x-shader/x-fragment">#version 300 es
        precision mediump float;
        
        in vec3 normal;
        in vec3 fragPos;
        in vec4 fragColor;

        uniform vec3 u_lightColor;
        uniform vec3 u_lightPos;

        uniform vec3 u_materialColor;

        out vec4 outputColor;
        void main(void) {

            // Ambient color
            float ambientStr = 0.1;
            vec3 ambient = ambientStr * u_lightColor;

            // Light direction
            vec3 norm = normalize(normal);
            vec3 lightDir = normalize(u_lightPos - fragPos);

            // diffuse color
            float diff = max(dot(norm, lightDir), 0.0);
            vec3 diffuse = diff * u_lightColor;

            vec3 result = u_materialColor * (ambient + diffuse);

            outputColor = fragColor * vec4(result, 1.0);
        }
    </script>
    <script id="phong-vs" type="x-shader/x-vertex">#version 300 es
        in vec3 a_position;
        in vec3 a_normal;
        in vec4 a_color;
      
        uniform mat4 u_model;
        uniform mat4 u_view;
        uniform mat4 u_perspective;
        uniform mat4 u_mNormal;

        out vec3 normal;
        out vec4 fragColor;
        out vec3 fragPos;
        void main(void) {
            normal = vec3(u_mNormal * vec4(a_normal, 0.0));
            fragPos = vec3(u_model * vec4(a_position, 1.0));
            fragColor = a_color;
            gl_Position = u_perspective * u_view * u_model * vec4(a_position, 1.0);
        }
    </script>
    <script id="phong-fs" type="x-shader/x-fragment">#version 300 es
        precision mediump float;
        
        in vec3 normal;
        in vec3 fragPos;
        in vec4 fragColor;

        uniform vec3 u_lightColor;
        uniform vec3 u_lightPos;
        
        uniform vec3 u_viewPos;

        uniform vec3 u_materialColor;

        out vec4 outputColor;
        void main(void) {

            // Ambient color
            float ambientStr = 0.1;
            vec3 ambient = ambientStr * u_lightColor;

            // Light direction
            vec3 norm = normalize(normal);
            vec3 lightDir = normalize(u_lightPos - fragPos);

            // diffuse color
            float diff = max(dot(norm, lightDir), 0.0);
            vec3 diffuse = diff * u_lightColor;

            // Specular color
            float specularStr = 0.5;
            vec3 viewDir = normalize(u_viewPos - fragPos);
            vec3 reflectDir = reflect(-lightDir, norm);

            float spec = pow( max( dot(viewDir, reflectDir), 0.0 ), 128.0 );
            vec3 specular = spec * u_lightColor;

            vec3 result = u_materialColor * (ambient + diffuse + specular);
            outputColor = fragColor * vec4(result, 1.0);
        }
    </script>
</body>
</html>